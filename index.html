<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>ANN BERRY MARCUS 字符阵列</title>
    <style>
        body { margin: 0; overflow: hidden; background: #050505; cursor: crosshair; }
        canvas { display: block; }
    </style>
</head>
<body>
<canvas id="canvas"></canvas>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d', { willReadFrequently: true });

let width, height;
let mouseX = 0, mouseY = 0;
let lastMouseX = 0, lastMouseY = 0;
let speed = 0;
let hueOffset = 0;

// 定义三个名字
const names = ["ANN", "BERRY", "MARCUS"];
const fontSize = 12; // 小字母的基础大小

function resize() {
    width = canvas.width = window.innerWidth;
    height = canvas.height = window.innerHeight;
}

window.addEventListener('resize', resize);
window.addEventListener('mousemove', (e) => {
    const dist = Math.sqrt(Math.pow(e.clientX - lastMouseX, 2) + Math.pow(e.clientY - lastMouseY, 2));
    speed = Math.min(dist, 100); 
    lastMouseX = e.clientX;
    lastMouseY = e.clientY;
});

resize();

const offscreen = document.createElement('canvas');
const octx = offscreen.getContext('2d');

function drawReference() {
    offscreen.width = width;
    offscreen.height = height;
    octx.fillStyle = "white";
    octx.textAlign = "center";
    octx.textBaseline = "middle";
    
    const mainFontSize = Math.min(width / 8, 150);
    
    // 绘制三个大字区域作为采样参考
    names.forEach((name, i) => {
        octx.font = `bold ${mainFontSize}px Arial`;
        octx.fillText(name, width / 2, height * (i + 1) / 4);
    });
}

function animate() {
    // 渐淡背景，制造丝滑的视觉残留
    ctx.fillStyle = 'rgba(5, 5, 5, 0.2)';
    ctx.fillRect(0, 0, width, height);

    drawReference();
    const imgData = octx.getImageData(0, 0, width, height).data;
    
    hueOffset += 0.5 + (speed / 10); // 移动越快，颜色转得越快
    
    // 遍历点阵
    // 我们步进大一点以容纳完整的小名字
    const stepX = 35; 
    const stepY = 15;

    for (let y = 0; y < height; y += stepY) {
        for (let x = 0; x < width; x += stepX) {
            const index = (Math.floor(y) * width + Math.floor(x)) * 4;
            
            if (imgData[index] > 128) {
                // 判断当前位置属于哪一个名字区域
                let activeName = "";
                if (y < height * 0.37) activeName = names[0];
                else if (y < height * 0.62) activeName = names[1];
                else activeName = names[2];

                // 颜色计算
                const h = (hueOffset + x/10) % 360;
                const s = 50 + (speed / 2);
                const l = 40 + (speed / 4);
                
                ctx.fillStyle = `hsl(${h}, ${s}%, ${l}%)`;
                ctx.font = `bold ${fontSize}px monospace`;
                
                // 增加一点点随机抖动，让画面更灵动
                const jitterX = (Math.random() - 0.5) * (speed / 5);
                const jitterY = (Math.random() - 0.5) * (speed / 5);
                
                ctx.fillText(activeName, x + jitterX, y + jitterY);
            }
        }
    }

    speed *= 0.95; // 速度摩擦力
    requestAnimationFrame(animate);
}

animate();
</script>
</body>
</html>
